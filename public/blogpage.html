<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BLOG PAGE</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Caprasimo&family=Fira+Code:wght@700&family=Ubuntu:wght@700&display=swap"
        rel="stylesheet">
    <!--FONT AWESOME-->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

    <!--GOOGLE FONTS-->
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@200&family=VT323&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Fredoka+One&family=Play&display=swap" rel="stylesheet">
</head>

<body>
    <style>
        * {
            margin: 0;
            padding: 0;
        }
        .article{
    background: #434858;
    padding: 6rem;
    border-radius: 12px;
    -webkit-margin-after: 4rem;
    margin-block-end: 4rem;
    font-size: 20px;
    font-family: 'Poppins', sans-serif;
}
article {
    display: block;
    color: white;
}

.width-wrapper {
    max-width: 1200px;
    margin: 0 auto;
    position: relative;
}
        body {
            position: relative;
            overflow-x: hidden;
            scroll-behavior: smooth;
            background-color: #30323e;
            background-image: linear-gradient(to bottom, rgba(0, 0, 0, 0.8), rgba(0, 0, 0, 0) 80px), url(blog-bg.png);
            background-size: 100vw;
            background-position: top center, top -90px right -5vw;
            background-repeat: no-repeat;
            background-attachment: scroll, fixed;

        }

        /* Customize scrollbar */
        body::-webkit-scrollbar {
            width: 6px;
            /* Adjust the width as needed */
        }

        body::-webkit-scrollbar-track {
            background: transparent;
        }

        body::-webkit-scrollbar-thumb {
            background: transparent;
            /* Make the scrollbar thumb transparent */
        }

        body::-webkit-scrollbar-thumb:hover {
            background: transparent;
            /* Make the scrollbar thumb transparent on hover */
        }

        header {
            display: block;
        }

        .main-header {
            display: flex;

        }

        nav {
            display: flex;

        }

        ul {
            list-style-type: none;

        }

        li {
            display: inline;

        }

        a {
            display: inline-block;
            padding: 10px;
            margin-top: 12px;
            color: white;
            text-decoration: none;
            font-size: 18px;
        }

        .logo {
            width: 220px;
            padding: 15px;
            margin-left: 10px;
        }

        .mega-header {
            padding: 3rem 2rem;
            color: white;
            margin-left: 80px;
        }

        .mega-header .subtitle {
            max-width: 650px;
            font-size: 20px;
            font-family: 'Lucida Sans', 'Lucida Sans Regular', 'Lucida Grande', 'Lucida Sans Unicode', Geneva, Verdana, sans-serif;
        }

        .head {
            font-size: 74px;
            font-weight: 700;
            text-shadow: 0 5px 5px rgba(0, 0, 0, 0.9);
            font-family: 'Ubuntu', sans-serif;
        }


        .primary-contact {
            padding-right: 820px;
        }

        .login {
            margin-right: 10px;
        }

       

        .footer {
      background: #000;
      padding: 30px 0px;
      font-family: 'Play', sans-serif;
      text-align: center;
    }

    .footer .row {
      width: 100%;
      margin: 1% 0%;
      padding: 0.6% 0%;
      color: gray;
      font-size: 0.8em;
    }

    .footer .row a {
      text-decoration: none;
      color: gray;
      transition: 0.5s;
    }

    .footer .row a:hover {
      color: #fff;
    }

    .footer .row ul {
      width: 100%;
    }

    .footer .row ul li {
      display: inline-block;
      margin: 0px 30px;
    }

    .footer .row a i {
      font-size: 2em;
      margin: 0% 1%;
    }

    #blogTitle{
    display: inline-block;
    padding: 10px;
    margin-top: 12px;
    color: white;
    font-size: 65px;
    text-decoration: underline;
    text-decoration-thickness: 5px;
    -moz-text-decoration-color: rgba(255, 255, 255, .1);
    text-decoration-color: rgba(255, 255, 255, .1);
}
        </style>
</head>

    <header class="main-header">
        <div class="logo">
            <img src="work.png" alt="logo" width="115px">
        </div>
        <nav>
            <ul>
                <li class="primary-blog">
                    <a href="/">Home</a>
                </li>
                <li class="primary-about">
                    <a href="/">About</a>
                </li>
                <li class="primary-contact">
                    <a href="/">Contact</a>
                </li>
            </ul>
        </nav>
    </header>
    <header class="mega-header">
        <div class="width-wrapper">
            <div class="block-time">
                <a href="/">← Back to Blogs</a>
            </div>
            <h1 id="blogTitle"></h1>
            <time id="blogCreatedAt"></time>
        </div>
    </header>
    
    <div class="page-wrap">
        <div class="width-wrapper">
            <article id="blogContent" class="article"></article>
            <img id="blogImage" src="" alt="Blog Image">
        </div>
    </div>
    <div class="comments-section">
        <h2>Comments</h2>
        <div id="commentsList"></div>
        <form id="commentForm">
            <textarea id="commentContent" placeholder="Write a comment..." required></textarea>
            <button type="submit">Post Comment</button>
        </form>
    </div>
    
            <footer>
                <div class="footer">
                    <div class="row">
                        <a href="#"><i class="fa fa-facebook"></i></a>
                        <a href="#"><i class="fa fa-instagram"></i></a>
                        <a href="#"><i class="fa fa-youtube"></i></a>
                        <a href="#"><i class="fa fa-twitter"></i></a>
                    </div>
        
                    <div class="row">
                        <ul>
                            <li><a href="#">Contact us</a></li>
                            <li><a href="#">Our Services</a></li>
                            <li><a href="#">Privacy Policy</a></li>
                            <li><a href="#">Terms & Conditions</a></li>
                            <li><a href="#">Career</a></li>
                        </ul>
                    </div>
        
                    <div class="row">
                        Copyright © 2023 - All rights reserved || Designed By: AKASH GUPTA
                    </div>
                </div>
            </footer>
            
            <script>

                // Function to replace newlines with <br> tags for displaying line breaks in HTML
        function insertLineBreaks(content) {
            // Use regular expression to replace newlines with <br> tags
            return content.replace(/\n/g, '<br>');
        }

                // Function to fetch the blog data using the blog ID from the backend API
                function fetchBlogData(blogId) {
                    return fetch(`/blogs/${blogId}`)
                        .then(response => response.json())
                        .catch(error => {
                            console.error("Error fetching blog data:", error);
                            return null;
                        });
                }
        
                // Function to parse query parameters from the URL
                function getQueryParams(url) {
                    const queryParams = {};
                    const params = new URLSearchParams(url.search);
                    for (const [key, value] of params.entries()) {
                        queryParams[key] = value;
                    }
                    return queryParams;
                }
                // Function to fetch comments for the current blog
function fetchComments(blogId) {
        fetch(`/api/blogs/${blogId}/comments`)
            .then(response => response.json())
            .then(comments => {
                const commentsList = document.getElementById('commentsList');
                commentsList.innerHTML = ''; // Clear existing comments

                comments.forEach(comment => {
                    const commentElement = document.createElement('div');
                    commentElement.className = 'comment';
                    commentElement.innerHTML = `
                        <div class="comment-content">${comment.content}</div>
                        <div class="comment-author">Posted by: ${comment.user_name}</div>
                    `;
                    commentsList.appendChild(commentElement);
                });
            })
            .catch(error => {
                console.error("Error fetching comments:", error);
            });
    }

     // Function to post a new comment
     function postComment(blogId, content) {
        fetch(`/api/blogs/${blogId}/comments`, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({
                content: content,
            }),
        })
        .then(response => response.json())
        .then(comment => {
            // Clear the comment form
            document.getElementById('commentContent').value = '';

            // Fetch comments again to update the comments list
            fetchComments(blogId);
        })
        .catch(error => {
            console.error("Error posting comment:", error);
        });
    }

                // Function to format the date and time in a 12-hour clock with AM/PM notation and a specific time zone
                function formatDateTime(dateTimeString) {
    const options = {
        year: 'numeric',
        month: 'long',
        day: 'numeric',
        hour: 'numeric',
        minute: 'numeric',
        hour12: true, // Use 12-hour clock with AM/PM notation
        timeZone: 'Asia/Kolkata' // Set the time zone to IST
    };
    return new Date(dateTimeString).toLocaleString(undefined, options);
}
        
                // Get the blog ID from the query parameters
                const queryParams = getQueryParams(window.location);
                const blogId = queryParams.id;
        
                // Fetch the blog data and update the content of the page
if (blogId) {
    fetchBlogData(blogId)
        .then(blogData => {
            if (blogData) {
                // Update other parts of the page
                document.getElementById('blogTitle').innerText = blogData.title;
                document.getElementById('blogContent').innerHTML = insertLineBreaks(blogData.content);
                document.getElementById('blogCreatedAt').innerText = 'Created At: ' + formatDateTime(blogData.created_at);

                // Update the image only if the image URL is available and not blank
                const blogImage = document.getElementById('blogImage');
                if (blogData.image && blogData.image.trim() !== '') {
                    blogImage.src = blogData.image;
                    blogImage.alt = 'Blog Image';
                } else {
                    // Hide the image element when no image URL is available or it's blank
                    blogImage.style.display = 'none';
                }
             // Update tags if available
    const blogTags = document.getElementById('blogTags');
    if (blogData.tags && blogData.tags.length > 0) {
        const tagsList = blogData.tags.map(tag => tag.name).join(', ');
        blogTags.innerText = 'Tags: ' + tagsList;
    } else {
        // If no tags are available, hide the tags section
        blogTags.style.display = 'none';
    }
} else {
    // Blog data not found or an error occurred
    console.error("Blog data not found or an error occurred.");
}
        });
} else {
    console.error("Blog ID not provided in the URL.");
}



    // Fetch comments for the current blog and update the comments section
    if (blogId) {
        fetchComments(blogId);
    }

    // Handle comment submission
    const commentForm = document.getElementById('commentForm');
    commentForm.addEventListener('submit', function(event) {
        event.preventDefault();
        const commentContent = document.getElementById('commentContent').value;
        if (commentContent.trim() !== '') {
            postComment(blogId, commentContent);
        }
    });
            </script>

            
        
        </body>
        
        </html>
        













    